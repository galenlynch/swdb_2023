

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Visual Behavior Ophys Dataset &#8212; SWDB 2023 DataBook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'visual-behavior/VBO-Dataset';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visual Behavior Ophys Experiment Data" href="VBO-ExperimentData.html" />
    <link rel="prev" title="Visual Behavior Ophys Dataset Overview" href="VB-Ophys.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Summer Workshop on the Dynamic Brain Databook
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../background/background.html">Background</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../background/Mouse-visual-system.html">Mouse visual system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/transgenic-tools.html">Transgenic tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../background/Two-photon-calcium-imaging.html">Two photon calcium imaging</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../background/Neuropixels-electrophysiology.html">Neuropixels electrophysiology</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/NP-Processing_Pipeline.html">Processing Pipeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../background/Ophys-ephys-comparison.html">Ophys ephys comparison</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visual-coding-2p/vc2p-background.html">Visual Coding 2-photon</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-2p/vc2p-dataset.html">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-2p/vc2p-session-data.html">Getting data from a session</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-2p/vc2p-stimuli.html">Visual stimuli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-2p/vc2p-evoked-response.html">Exercise: Evoked response</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-2p/vc2p-cross-session-data.html">Cross session data</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visual-coding-np/vcnp.html">Visual Coding — Neuropixels</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-quickstart.html">Quick start guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-data-access.html">Accessing Neuropixels Visual Coding Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-quality-metrics.html">Unit Quality Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-units.html">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-receptive-fields.html">Receptive fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-lfp.html">Local field potential (LFP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-optotagging.html">Optotagging Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-session.html">Extracellular Electrophysiology Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visual-coding-np/vcnp-links.html">Other resources</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cell-type-lookup-table/ctlut-background.html">Cell Type Look-up Table</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cell-type-lookup-table/ctlut-session-data.html">Session data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cell-type-lookup-table/ctlut-optotagging.html">Optotagging</a></li>





<li class="toctree-l2"><a class="reference internal" href="../cell-type-lookup-table/ctlut-accessing-data.html">Accessing cell type lookup table data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cell-type-lookup-table/ctlut-identifying-tagged-units.html">Identifying tagged neurons</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="vb-background.html">Visual Behavior</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="VB-Behavior.html">Visual Behavior Task</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="VB-BehaviorSessionData.html">Tutorial Accessing Behavior Session Data</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="VB-Ophys.html">Visual Behavior Ophys</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Visual Behavior Ophys Dataset</a></li>




<li class="toctree-l3"><a class="reference internal" href="VBO-ExperimentData.html">Ophys Experiment Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="VBO-Tutorial-Compare_trial_types.html">Tutorial Comparing Trial Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="VBO-Tutorial-Downloading_data_and_navigating_the_manifest.html">Tutorial Downloading Data</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="VB-Neuropixels.html">Visual Behavior Neuropixels</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="VBN-Dataset.html">Visual Behavior Neuropixels Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="VBN-SessionData.html">Visual Behavior Neuropixels Session</a></li>
<li class="toctree-l3"><a class="reference internal" href="VBN-Tutorial-Aligning_Neural_Data_to_Stimuli.html">Tutorial Aligning Neural Data to Stimuli</a></li>
<li class="toctree-l3"><a class="reference internal" href="VBN-Tutorial-Aligning_Behavior_Data_to_Task_Events.html">Tutorial Aligning Behavioral Data to Task Events</a></li>
<li class="toctree-l3"><a class="reference internal" href="VBN-Tutorial-Analyzing_LFP_Data.html">Tutorial Analyzing LFP data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../microns-em/em-background.html">EM Connectomics</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-structural-data.html">Dataset Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/proofreading.html">Proofreading and Data Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-neuroglancer.html">Neuroglancer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-dash-apps.html">Dash Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-caveclient-setup.html">Setting up CAVEclient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-querying-tables.html">Programmatic Access</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/key-tables.html">Annotation Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-volume-data.html">Imagery and Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-skeletons.html">Skeletons</a></li>








<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-meshes.html">Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-functional_data.html">MICrONS Functional Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../microns-em/em-ultrastructure.html">Ultrastructure Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fvisual-behavior/VBO-Dataset.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/visual-behavior/VBO-Dataset.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visual Behavior Ophys Dataset</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Visual Behavior Ophys Dataset</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vbo-metadata-tables">VBO Metadata Tables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#behavior-sessions">Behavior sessions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-sessions">Ophys sessions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-experiments">Ophys experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-cells">Ophys cells</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#behavior-sessions-table">Behavior Sessions Table</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mouse-specific-metadata">Mouse specific metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-variants">Dataset variants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-types">Session Types</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-sessions-table">Ophys Sessions Table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-experiment-table">Ophys Experiment Table</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaging-plane-specific-metadata">Imaging plane specific metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-session-types">Properties of session types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-containers">Ophys containers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-cells-table">Ophys cells table</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="visual-behavior-ophys-dataset">
<h1>Visual Behavior Ophys Dataset<a class="headerlink" href="#visual-behavior-ophys-dataset" title="Permalink to this heading">#</a></h1>
<p>The main entry point to the VBO dataset is the <code>VisualBehaviorOphysProjectCache</code> class.  This class is responsible for downloading any requested data or metadata as needed and storing it in well known locations.  For detailed info about how to access this data, check out <a class="reference external" href="https://allensdk.readthedocs.io/en/latest/_static/examples/nb/visual_behavior_ophys_data_access.html">this tutorial</a></p>
<p>We begin by importing the <code>VisualBehaviorOphysProjectCache</code>  class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">allensdk.brain_observatory.behavior.behavior_project_cache</span> <span class="kn">import</span> <span class="n">VisualBehaviorOphysProjectCache</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/envs/allensdk/lib/python3.8/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div>
</div>
</div>
</div>
<p>Now we can specify our cache directory and set up the cache.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this path should point to the location of the dataset on your platform</span>
<span class="n">cache_dir</span> <span class="o">=</span> <span class="s1">&#39;/root/capsule/data/visual-behavior-ophys/&#39;</span>

<span class="n">cache</span> <span class="o">=</span> <span class="n">VisualBehaviorOphysProjectCache</span><span class="o">.</span><span class="n">from_local_cache</span><span class="p">(</span>
            <span class="n">cache_dir</span><span class="o">=</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">use_static_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># this path should point to the location of the dataset on your platform</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">cache_dir</span> <span class="o">=</span> <span class="s1">&#39;/root/capsule/data/visual-behavior-ophys/&#39;</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">cache</span> <span class="o">=</span> <span class="n">VisualBehaviorOphysProjectCache</span><span class="o">.</span><span class="n">from_local_cache</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>             <span class="n">cache_dir</span><span class="o">=</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">use_static_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File /opt/envs/allensdk/lib/python3.8/site-packages/allensdk/brain_observatory/behavior/behavior_project_cache/project_cache_base.py:110,</span> in <span class="ni">ProjectCacheBase.from_local_cache</span><span class="nt">(cls, cache_dir, use_static_cache)</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span> <span class="nd">@classmethod</span>
<span class="g g-Whitespace">     </span><span class="mi">88</span> <span class="k">def</span> <span class="nf">from_local_cache</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span>     <span class="bp">cls</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">90</span>     <span class="n">cache_dir</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
<span class="g g-Whitespace">     </span><span class="mi">91</span>     <span class="n">use_static_cache</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">     </span><span class="mi">92</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ProjectCacheBase&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">93</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;instantiates this object with a local cache.</span>
<span class="g g-Whitespace">     </span><span class="mi">94</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">95</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">109</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">110</span>     <span class="n">fetch_api</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">cloud_api_class</span><span class="p">()</span><span class="o">.</span><span class="n">from_local_cache</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span>         <span class="n">cache_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span>         <span class="n">project_name</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">PROJECT_NAME</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">113</span>         <span class="n">ui_class_name</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>         <span class="n">use_static_cache</span><span class="o">=</span><span class="n">use_static_cache</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span>     <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">fetch_api</span><span class="o">=</span><span class="n">fetch_api</span><span class="p">)</span>

<span class="nn">File /opt/envs/allensdk/lib/python3.8/site-packages/allensdk/brain_observatory/behavior/behavior_project_cache/project_apis/data_io/project_cloud_api_base.py:143,</span> in <span class="ni">ProjectCloudApiBase.from_local_cache</span><span class="nt">(cls, cache_dir, project_name, ui_class_name, use_static_cache)</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span><span class="w"> </span><span class="sd">&quot;&quot;&quot;instantiates this object with a local cache.</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">124</span><span class="sd"> Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">141</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="k">if</span> <span class="n">use_static_cache</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">143</span>     <span class="n">cache</span> <span class="o">=</span> <span class="n">StaticLocalCache</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span>         <span class="n">cache_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span>         <span class="n">project_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>         <span class="n">ui_class_name</span><span class="o">=</span><span class="n">ui_class_name</span>
<span class="g g-Whitespace">    </span><span class="mi">147</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">148</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>     <span class="n">cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>         <span class="n">cache_dir</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>         <span class="n">project_name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>         <span class="n">ui_class_name</span><span class="o">=</span><span class="n">ui_class_name</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>     <span class="p">)</span>

<span class="nn">File /opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:1245,</span> in <span class="ni">StaticLocalCache.__init__</span><span class="nt">(self, cache_dir, project_name, ui_class_name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1244</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cache_dir</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">ui_class_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1245</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cache_dir</span><span class="o">=</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1246</span>                      <span class="n">ui_class_name</span><span class="o">=</span><span class="n">ui_class_name</span><span class="p">)</span>

<span class="nn">File /opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:78,</span> in <span class="ni">BasicLocalCache.__init__</span><span class="nt">(self, cache_dir, project_name, ui_class_name)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span> <span class="o">=</span> <span class="n">cache_dir</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="bp">self</span><span class="o">.</span><span class="n">_project_name</span> <span class="o">=</span> <span class="n">project_name</span>
<span class="ne">---&gt; </span><span class="mi">78</span> <span class="bp">self</span><span class="o">.</span><span class="n">_manifest_file_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_all_manifests</span><span class="p">()</span>

<span class="nn">File /opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:1258,</span> in <span class="ni">StaticLocalCache._list_all_manifests</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1254</span> <span class="n">manifest_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1255</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="s2">&quot;manifests&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">manifest_dir</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1258</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1259</span>         <span class="sa">f</span><span class="s2">&quot;Expected the provided cache_dir (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_dir</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1260</span>         <span class="s2">&quot;to have the following subfolders but it did not: &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1261</span>         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="si">}</span><span class="s2">/manifests&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1262</span>     <span class="p">)</span>
<span class="nn">   1264 output = [x for x</span> in <span class="ni">os.listdir</span><span class="nt">(manifest_dir)</span>
<span class="g g-Whitespace">   </span><span class="mi">1265</span>           <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="s2">&quot;.*_manifest_v.*.json&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)]</span>
<span class="g g-Whitespace">   </span><span class="mi">1267</span> <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_find_latest_file</span><span class="p">(</span><span class="n">output</span><span class="p">)]</span>

<span class="ne">RuntimeError</span>: Expected the provided cache_dir (/root/capsule/data/visual-behavior-ophys/)to have the following subfolders but it did not: visual-behavior-ophys/manifests
</pre></div>
</div>
</div>
</div>
<p>We can use the <code>VisualBehaviorOphysProjectCache</code> to explore the parameters of this dataset. Let’s start by examining the cache metadata tables.</p>
</section>
<section id="vbo-metadata-tables">
<h1>VBO Metadata Tables<a class="headerlink" href="#vbo-metadata-tables" title="Permalink to this heading">#</a></h1>
<p>The data manifest consists of 4 tables:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ophys_session_table</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ophys_cells_table</span></code></p></li>
</ol>
<section id="behavior-sessions">
<h2>Behavior sessions<a class="headerlink" href="#behavior-sessions" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code> contains metadata for every <b>behavior session</b> in the dataset, including the full training history for each mouse. Accordingly, some behavior sessions have 2-photon data associated with them, and will have a corresponding <code class="docutils literal notranslate"><span class="pre">ophys_session_id</span></code>, while others took place during training in the behavior facility. The different training stages that mice are progressed through are described by the <code class="docutils literal notranslate"><span class="pre">session_type</span></code>.</p>
</section>
<section id="ophys-sessions">
<h2>Ophys sessions<a class="headerlink" href="#ophys-sessions" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ophys_session_table</span></code> contains metadata for every 2-photon imaging (aka optical physiology, or ophys) session in the dataset, associated with a unique <code class="docutils literal notranslate"><span class="pre">ophys_session_id</span></code>. An <b>ophys session</b> is one continuous recording session under the microscope, and can contain different numbers of imaging planes (aka <code class="docutils literal notranslate"><span class="pre">ophys_experiments</span></code>) depending on which microscope was used. For imaging sessions using the Scientifica single-plane 2P microscope, there will only be one experiment (aka imaging plane) per session. For Multiscope sessions using the multi-plane 2-photon microscope, there can be up to eight imaging planes per session. Quality Control (QC) is performed on each individual imaging plane within a session, so each can fail QC independent of the others. This means that a Multiscope session may not have exactly eight experiments (imaging planes).</p>
</section>
<section id="ophys-experiments">
<h2>Ophys experiments<a class="headerlink" href="#ophys-experiments" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code> contains metadata for every <b>ophys experiment</b> in the dataset, which corresponds to a single imaging plane recorded in a single session at a specific <code class="docutils literal notranslate"><span class="pre">imaging_depth</span></code> and <code class="docutils literal notranslate"><span class="pre">targeted_structure</span></code>, and associated with a unique <code class="docutils literal notranslate"><span class="pre">ophys_experiment_id</span></code>. A key part of the experimental design is targeting a given population of neurons, contained in one imaging plane, across multiple days with several different <code class="docutils literal notranslate"><span class="pre">session_types</span></code> (further described below) to examine the impact of varying sensory and behavioral conditions on single cell responses.</p>
<p>The collection of all imaging sessions for a given imaging plane is referred to as an <b>ophys container</b>, associated with a unique <code class="docutils literal notranslate"><span class="pre">ophys_container_id</span></code>. If the data for a given <code class="docutils literal notranslate"><span class="pre">session_type</span></code> does not meet the QC criteria on the first try, an attempt is made to re-acquire the session_type on a different recording day (this is called a retake). Thus each <b>ophys container</b> may contain different numbers of sessions, depending on which sessions and imaging planes passed QC, and how many retakes occured.</p>
</section>
<section id="ophys-cells">
<h2>Ophys cells<a class="headerlink" href="#ophys-cells" title="Permalink to this heading">#</a></h2>
<p>The `ophys_cells_table` contains the unique IDs of all cells recorded across all experiments. Each cell has two IDs. The `cell_roi_id` is the ID of the cell in a specific session, the `cell_specimen_id` is the ID of the cell after matching across sessions. Thus, the `cell_roi_id` will be unique to a given `ophys_experiment_id` and `ophys_session_id` while the `cell_specimen_id` will be shared across all `phys_session_ids` for a given `ophys_container_id`. As a reminder, the `ophys_container_id` links the same imaging plane recorded across multiple sessions. 
<p>To understand the difference between an <b>ophys experiment</b>, an <b>ophys session</b>, and an <b>ophys container</b>, the following schematic can be helpful</p>
<p><img alt="data_structure" src="../_images/vbo_data_structure.png" /></p>
<p>Note that this represents a multi-plane imaging dataset. For single-plane imaging, there will only be one plane (one <b>ophys experiment</b>), corresponding to one row of this diagram.</p>
<p><b>Let’s look at each of these tables in more detail to learn more about what is in the dataset.</b></p>
</section>
</section>
<section id="behavior-sessions-table">
<h1>Behavior Sessions Table<a class="headerlink" href="#behavior-sessions-table" title="Permalink to this heading">#</a></h1>
<p>In this dataset, mice are trained on a visual change detection task. This task involves a continuous stream of stimuli, and mice learn to lick in response to a change in the stimulus identity to earn a water reward. There are different stages of training in this task, described below. The metadata for each behavior session in the dataset can be found in the <code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code> and can be used to identify behavior sessions you may want to analyze.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code> includes every session for every mouse in the dataset, regardless of whether it occured during 2-photon imaging or during behavior training.</p>
<p>Here is how to load the <code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code> from the cache</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">behavior_sessions</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_behavior_session_table</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of behavior sessions: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">behavior_sessions</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>This table gives us lots of useful metadata about each behavior session, including the genotype, sex and age of the mouse, the experimental design that was used (indicated by the <code class="docutils literal notranslate"><span class="pre">project_code</span></code>), the type of session that was run, and whether the session occured under a 2-photon microscope or in the behavior training facility.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<p>Here is a brief description of each column:</p>
<dl class="simple myst">
<dt>age_in_days</dt><dd><p>int age of mouse in days</p>
</dd>
<dt>cre_line</dt><dd><p>string	cre driver line for a transgenic mouse</p>
</dd>
<dt>date_of_acquisition</dt><dd><p>date time object	date and time of experiment acquisition, yyyy-mm-dd hh:mm:ss.</p>
</dd>
<dt>driver_line</dt><dd><p>list of string	all driver lines for transgenic mouse</p>
</dd>
<dt>equipment_name</dt><dd><p>string	identifier for equipment data was collected on</p>
</dd>
<dt>file_id</dt><dd><p>int	 lookup id to retrieve NWB file from S3 or the local cache</p>
</dd>
<dt>full_genotype</dt><dd><p>string	full genotype of transgenic mouse</p>
</dd>
<dt>indicator</dt><dd><p>string	calcium indicator associated with transgenic mouse reporter line</p>
</dd>
<dt>mouse_id</dt><dd><p>int	unique identifier for a mouse</p>
</dd>
<dt>ophys_container_id</dt><dd><p>int	unique identifier for all ophys containers (grouping of ophys experiments for a given imaging plane) associated with the behavior session</p>
</dd>
<dt>ophys_experiment_id</dt><dd><p>int	unique identifier for all ophys experiments (imaging planes) associated with the behavior session</p>
</dd>
<dt>ophys_session_id</dt><dd><p>int	unique identifier for the ophys session associated with the behavior session</p>
</dd>
<dt>prior_exposures_to_image_set</dt><dd><p>float 64	number of prior sessions where the mouse was exposed to the image set used in the current session, starting at 0 for first exposure</p>
</dd>
<dt>prior_exposures_to_omissions</dt><dd><p>int 64	number of prior sessions where the mouse exposed to stimulus omissions, starting at 0 for first exposure</p>
</dd>
<dt>prior_exposures_to_session_type</dt><dd><p>int 64	number of prior sessions where the mouse was exposed to the session type of the current session, starting at 0 for first exposure</p>
</dd>
<dt>project_code</dt><dd><p>string dataset variant the mouse belongs to, determined by whether single or multi-plane imaging was used, which stimulus set was used during training, and what areas and depths were recorded during ophys</p>
</dd>
<dt>reporter_line</dt><dd><p>string	reporter line for transgenic mouse</p>
</dd>
<dt>session_number</dt><dd><p>float 64	 for ophys (non-training) sessions only, session number is the number associated with the session type. (Eg. OPHYS_2_images_A_passive has session_number 2). NaN for training sessions.</p>
</dd>
<dt>session_type</dt><dd><p>string	type of session indicating whether the session was during behavior training or ophys, which visual stimulus was shown, and whether the session was active behavior or passive imaging</p>
</dd>
<dt>sex</dt><dd><p>string	sex of the mouse</p>
</dd>
</dl>
<section id="mouse-specific-metadata">
<h2>Mouse specific metadata<a class="headerlink" href="#mouse-specific-metadata" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mouse_id</span></code> is a 6-digit unique identifier for each experimental animal in the dataset</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;there are &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">mouse_id</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="s1">&#39;mice in the dataset&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The transgenic line determines which neurons are labeled in a given mouse, and what they are labeled with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the different transgenic lines included in this dataset are:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">full_genotype</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">full_genotype</span></code> refers to the full name of the transgenic mouse line, including all driver and reporter lines in the cross. <code class="docutils literal notranslate"><span class="pre">driver_line</span></code> and <code class="docutils literal notranslate"><span class="pre">reporter_line</span></code> have their own unique columns in the table. The first element of the <code class="docutils literal notranslate"><span class="pre">full_genotype</span></code> is the <code class="docutils literal notranslate"><span class="pre">cre_line</span></code> (which also has its own column in the table, and is a subset of <code class="docutils literal notranslate"><span class="pre">driver_line</span></code>). The <code class="docutils literal notranslate"><span class="pre">cre_line</span></code> determines which genetically identified neuron type will be labeled by the <code class="docutils literal notranslate"><span class="pre">reporter_line</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the different cre lines used in this dataset are:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">cre_line</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<p><img alt="transgenic_lines" src="../_images/vbo_transgenic_lines.png" /></p>
<p>In this dataset, there are 3 <code class="docutils literal notranslate"><span class="pre">cre_lines</span></code>, ‘Slc17a7-IRES2-Cre’, which labels excitatory neurons across all cortical layers, ‘Sst-IRES-Cre’ which labels somatostatin expressing inhibitory interneurons, and ‘Vip-IRES-Cre’, which labels vasoactive intestinal peptide expressing inhibitory interneurons.</p>
<p>There are also 3 <code class="docutils literal notranslate"><span class="pre">reporter_lines</span></code>, ‘Ai93(TITL-GCaMP6f)’ which expresses the genetically encoded calcium indicator GCaMP6f (f is for ‘fast’, this reporter has fast offset kinetics, but is only moderately sensitive to calcium relative to other sensors) in cre labeled neurons, ‘Ai94(TITL-GCaMP6s)’ which expresses the indicator GCaMP6s (s is for ‘slow’, this reporter is very sensitive to calcium but has slow offset kinetics), and ‘Ai148(TIT2L-GC6f-ICL-tTA2’, which  expresses GCaMP6f using a self-enhancing system to achieve higher expression than other reporter lines (which proved necessary to label inhibitory neurons specifically). The specific <code class="docutils literal notranslate"><span class="pre">indicator</span></code> expressed by each <code class="docutils literal notranslate"><span class="pre">reporter_line</span></code> also has its own column in the table.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the different reporter lines used in this dataset are:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">reporter_line</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the different indicators used in this dataset are:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">indicator</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<ul class="simple">
<li><p>For more information about transgenic lines, see characterization data here: https://observatory.brain-map.org/visualcoding/transgenic</p></li>
<li><p>for more information on GCaMP6, see this paper: https://www.nature.com/articles/nature12354</p></li>
<li><p>For more information on reporter lines, see these papers: https://doi.org/10.1016/j.neuron.2015.02.022, https://www.sciencedirect.com/science/article/pii/S0092867418308031</p></li>
</ul>
<p>How many mice per transgenic line?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;full_genotype&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;full_genotype&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[[</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</section>
<section id="dataset-variants">
<h2>Dataset variants<a class="headerlink" href="#dataset-variants" title="Permalink to this heading">#</a></h2>
<p>Different groups of mice were trained on the task using different image sets and were imaged using different microscopes. These distinct groups of mice are referred to as <b>dataset variants</b> and can be identified using the <code class="docutils literal notranslate"><span class="pre">project_code</span></code> column.</p>
<p><img alt="data_variants" src="../_images/vbo_dataset_variants.png" /></p>
<p>What are the <code class="docutils literal notranslate"><span class="pre">project_codes</span></code>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">project_code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<p>For project codes <code class="docutils literal notranslate"><span class="pre">VisualBehavior</span></code> and <code class="docutils literal notranslate"><span class="pre">VisualBehaviorMultiscope</span></code>, mice were trained on image set A, while for <code class="docutils literal notranslate"><span class="pre">VisualBehaviorTask1B</span></code>, mice are trained on image set B. In the <code class="docutils literal notranslate"><span class="pre">VisualBehaviorMultiscope4areasx2d</span></code> project code, mice were trained with image set G. Two images from image set G were included in the novel image set H.</p>
<p>Collecting datasets from two groups of mice with swapped stimulus conditions (<code class="docutils literal notranslate"><span class="pre">VisualBehavior</span></code> and <code class="docutils literal notranslate"><span class="pre">VisualBehaviorTask1B</span></code>) provides as a control for the effects of novelty, to ensure that any observed changes were truly due to lack of familiarity with the novel image set, rather than a result of specific features of the image set that was used.</p>
<p>In addition, some mice were imaged on the Scientifica single plane imaging systems (<code class="docutils literal notranslate"><span class="pre">VisualBehavior</span></code> and <code class="docutils literal notranslate"><span class="pre">VisualBehaviorTask1B</span></code>), and other mice were imaged on Multiscope for multi-plane imaging (<code class="docutils literal notranslate"><span class="pre">VisualBehaviorMultiscope</span></code> and <code class="docutils literal notranslate"><span class="pre">VisualBehaviorMultiscope4areasx2d</span></code>).</p>
<p><b> behavior sessions can take place on different experimental systems </b></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;behavior data could be recorded on these experimental systems:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">equipment_name</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">equipment_name</span></code> values starting with ‘BEH’ indicate behavioral training in the behavior facility, while values starting with ‘CAM2P’ or ‘MESO’ indicate behavior sessions that took place under a 2-photon microscope - either a Scientifica single plane imaging system (‘CAMP2P.4’, ‘CAM2P.4’, or ‘CAM2P.5’) or a modified Mesoscope system, also called Multiscope, for multi-plane imaging (‘MESO.1’).</p>
<p><b> Getting the project code for all sessions for each mouse </b></p>
<p>You may have noticed that one of the values of <code class="docutils literal notranslate"><span class="pre">project_code</span></code> was <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. This is because project_code is only defined for ophys sessions, so let’s fill in the gaps so that all mice have a project_code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get a table of the project code for each mouse</span>
<span class="n">project_code_lookup</span> <span class="o">=</span> <span class="n">behavior_sessions</span><span class="p">[</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">project_code</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">==</span><span class="kc">False</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">)[[</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">,</span><span class="s1">&#39;project_code&#39;</span><span class="p">]]</span>
<span class="n">project_code_lookup</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">behavior_sessions</span> <span class="o">=</span> <span class="n">behavior_sessions</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">project_code_lookup</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;mouse_id&#39;</span><span class="p">,</span>
                                            <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_session&#39;</span><span class="p">,</span> <span class="s1">&#39;_mouse&#39;</span><span class="p">))</span>
<span class="n">behavior_sessions</span> <span class="o">=</span> <span class="n">behavior_sessions</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;project_code_session&#39;</span><span class="p">)</span>
<span class="n">behavior_sessions</span> <span class="o">=</span> <span class="n">behavior_sessions</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;project_code_mouse&#39;</span><span class="p">:</span> <span class="s1">&#39;project_code&#39;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="session-types">
<h2>Session Types<a class="headerlink" href="#session-types" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">session_type</span></code> for each behavior session indicates the behavioral training stage or 2-photon imaging conditions for that particular session. This determines what stimuli were shown and what task parameters were used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the session_types available in this dataset are:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">session_type</span><span class="p">[</span>
                  <span class="o">~</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">session_type</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<p><b> <code class="docutils literal notranslate"><span class="pre">TRAINING</span></code> session types </b></p>
<p>Mice are progressed through a series of training stages to shape their behavior prior to 2-photon imaging. Mice are automatically advanced between stages depending on their behavioral performance. For a detailed description of the change detection task and advancement criteria, please see the <a class="reference external" href="https://brainmapportal-live-4cc80a57cd6e400d854-f7fdcae.divio-media.net/filer_public/4e/be/4ebe2911-bd38-4230-86c8-01a86cfd758e/visual_behavior_2p_technical_whitepaper.pdf">Technical Whitepaper</a></p>
<p><img alt="training" src="../_images/automated_training.png" /></p>
<p>Training with the change detection task begins with simple static grating stimuli, changing between 0 and 90 degrees in orientation. On the very first day, mice are automatically given a water reward when the orientation of the stimulus changes (<code class="docutils literal notranslate"><span class="pre">TRAINING_0_gratings_autorewards_15min</span></code>). On subsequent days, mice must lick following the change in order to receive a water reward (<code class="docutils literal notranslate"><span class="pre">TRAINING_1_gratings</span></code>). In the next stage, stimuli are flashed, with a 500ms inter stimulus interal of mean luminance gray screen (<code class="docutils literal notranslate"><span class="pre">TRAINING_2_gratings_flashed</span></code>).</p>
<p>Once mice perform the task well with gratings, they are transitioned to natural image stimuli. Different groups of mice are trained with different sets of images, as described in the <code class="docutils literal notranslate"><span class="pre">project_code</span></code> section above. In the following description, we use <code class="docutils literal notranslate"><span class="pre">X</span></code> as a placeholder for image set <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code> and <code class="docutils literal notranslate"><span class="pre">H</span></code> in the <code class="docutils literal notranslate"><span class="pre">session_type</span></code> name.</p>
<p>Training with images begins with a 10ul water reward volume (<code class="docutils literal notranslate"><span class="pre">TRAINING_3_images_X_10uL_reward</span></code>), which is then decreased to 7ul once mice perform the task consistently with images (<code class="docutils literal notranslate"><span class="pre">TRAINING_4_images_X_training</span></code>). When mice have reached criterion to be transferred to the 2-photon imaging portion of the experiment, they are labeled as ‘handoff_ready’ (<code class="docutils literal notranslate"><span class="pre">TRAINING_4_images_X_handoff_ready</span></code>.) If behavior performance returns to below criterion level, they are labeled as ‘handoff_lapsed’(<code class="docutils literal notranslate"><span class="pre">TRAINING_4_images_X_handoff_lapsed</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># reminder about possible session types </span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the different session_types available in this dataset are:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">session_type</span><span class="p">[</span>
                  <span class="o">~</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">session_type</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
</pre></div>
</div>
<p>Some mice only go up to <code class="docutils literal notranslate"><span class="pre">TRAINING_4</span></code>, while others have an additional training stage labeled <code class="docutils literal notranslate"><span class="pre">TRAINING_5</span></code>. This is due to a minor change made partway through data collection, where an <code class="docutils literal notranslate"><span class="pre">epilogue</span></code> stimulus was introduced during the final training stage prior to 2-photon imaging, in order to habituate the mice to this stimulus, which is used during 2-photon imaging to aid in session to session registration. The <code class="docutils literal notranslate"><span class="pre">epilogue</span></code> stimulus is a 30 second movie clip repeated 10 times, for a total of 5 minutes, that occurs at the end of the <code class="docutils literal notranslate"><span class="pre">OPHYS</span></code> sessions. Training sessions with an epilogue movie include <code class="docutils literal notranslate"><span class="pre">TRAINING_5_images_X_epilogue</span></code>, <code class="docutils literal notranslate"><span class="pre">TRAINING_5_images_X_handoff_ready</span></code> , <code class="docutils literal notranslate"><span class="pre">TRAINING_5_images_X_handoff_lapsed</span></code>.</p>
<p><b> <code class="docutils literal notranslate"><span class="pre">OPHYS</span></code> session types </b></p>
<p>When mice are transferred to the 2-photon rig for the imaging portion of the experiment, they first undergo 1-3 habituation sessions to get accustomed to the new experimental environment (<code class="docutils literal notranslate"><span class="pre">OPHYS_0_images_X_habituation</span></code>). During these sessions, mice perform the task under the microscope, but no experimental data is recorded.</p>
<p>During the 2-photon imaging portion of the experiment, mice perform the task with the same set of images they saw during training , as well as an additional novel set of images that they did not see during training. This allows evaluation of the impact of different sensory contexts on neural activity - familiarity versus novelty. Sessions with <b>familiar images</b> include those starting with <code class="docutils literal notranslate"><span class="pre">OPHYS_0</span></code>, <code class="docutils literal notranslate"><span class="pre">OPHYS_1</span></code>, <code class="docutils literal notranslate"><span class="pre">OPHYS_2</span></code>, and <code class="docutils literal notranslate"><span class="pre">OPHYS_3</span></code>. Sessions with <b>novel images</b> include those starting with <code class="docutils literal notranslate"><span class="pre">OPHYS_4</span></code>, <code class="docutils literal notranslate"><span class="pre">OPHYS_5</span></code>, and <code class="docutils literal notranslate"><span class="pre">OPHYS_6</span></code>.</p>
<p><img alt="experimental_design" src="../_images/vbo_experimental_design_sessions.png" /></p>
<p>Interleaved between active behavior sessions are <b>passive viewing</b> sessions where mice are given their daily water ahead of the sesssion (and are thus satiated) and view the stimulus with the lick spout retracted so they are unable to earn water rewards. This allows comparison of neural activity in response to stimuli under different behavioral contexts - active task engagement and passive viewing without reward. Passive sessions include <code class="docutils literal notranslate"><span class="pre">OPHYS_2_images_A_passive</span></code> (passive session with familiar images), and <code class="docutils literal notranslate"><span class="pre">OPHYS_5_images_A_passive</span></code> (passive session with novel images).</p>
<p><b> What <code class="docutils literal notranslate"><span class="pre">session_types</span></code> belong to each <code class="docutils literal notranslate"><span class="pre">project_code</span></code>? </b></p>
<p>As described above, mice belonging to different <code class="docutils literal notranslate"><span class="pre">project_codes</span></code> were trained with different image sets, which are indicated by the <code class="docutils literal notranslate"><span class="pre">session_type</span></code>. Lets check which <code class="docutils literal notranslate"><span class="pre">session_types</span></code> exist for each <code class="docutils literal notranslate"><span class="pre">project_code</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">project_code</span> <span class="ow">in</span> <span class="n">behavior_sessions</span><span class="o">.</span><span class="n">project_code</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span> 
    <span class="n">project_sessions</span> <span class="o">=</span> <span class="n">behavior_sessions</span><span class="p">[</span><span class="n">behavior_sessions</span><span class="o">.</span><span class="n">project_code</span><span class="o">==</span><span class="n">project_code</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> project_code:&#39;</span><span class="p">,</span> <span class="n">project_code</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> has these session types:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
        <span class="n">project_sessions</span><span class="o">.</span><span class="n">session_type</span><span class="p">[</span><span class="o">~</span><span class="n">project_sessions</span><span class="o">.</span><span class="n">session_type</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">unique</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="ophys-sessions-table">
<h1>Ophys Sessions Table<a class="headerlink" href="#ophys-sessions-table" title="Permalink to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ophys_session_table</span></code> includes all of the metadata columns available in the <code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code>, but is indexed using the <code class="docutils literal notranslate"><span class="pre">ophys_session_id</span></code> instead of the <code class="docutils literal notranslate"><span class="pre">behavior_session_id</span></code>, and only includes session types beginning in <code class="docutils literal notranslate"><span class="pre">OPHYS</span></code> that passed quality control and have 2-photon data available for analysis.</p>
<p>All Scientifica experiments were performed in the primary visual cortex (VISp), while Multiscope experiments had different combinations of <code class="docutils literal notranslate"><span class="pre">imaging_depth</span></code> and <code class="docutils literal notranslate"><span class="pre">targeted_structure</span></code>, with 4 imaging depths and 2 targeted structures for <code class="docutils literal notranslate"><span class="pre">VisualBehaviorMultiscope</span></code>, and 2 imaging depths and 4 targeted structures for <code class="docutils literal notranslate"><span class="pre">VisualBehaviorMultiscope4areasx2d</span></code>. The information about which areas and depths were imaged in each session is available in the <code class="docutils literal notranslate"><span class="pre">ophys_session_table</span></code>, as you will see below.</p>
<p>How many ophys sessions are available?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ophys_sessions</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_ophys_session_table</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of ophys sessions: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ophys_sessions</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>What columns does the <code class="docutils literal notranslate"><span class="pre">ophys_session_table</span></code> have?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ophys_sessions</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<p>How many imaging planes, indicated by a unique <code class="docutils literal notranslate"><span class="pre">ophys_experiment_id</span></code> are there for each <b>ophys session</b>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># what do the ophys_experiment_id and ophys_container_id columns look like? </span>
<span class="c1"># are there always the same number of experiments and containers in different sessions? </span>
<span class="c1"># does the number of experiments and containers depend on the microscope used? </span>
<span class="n">ophys_sessions</span><span class="p">[[</span><span class="s1">&#39;ophys_experiment_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ophys_container_id&#39;</span><span class="p">,</span> <span class="s1">&#39;equipment_name&#39;</span><span class="p">]][:</span><span class="mi">15</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="ophys-experiment-table">
<h1>Ophys Experiment Table<a class="headerlink" href="#ophys-experiment-table" title="Permalink to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code> contains all ophys data that is available for analysis, organized by the <code class="docutils literal notranslate"><span class="pre">ophys_experiment_id</span></code> which is associated with an single imaging plane in a single session.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code> contains all the columns in <code class="docutils literal notranslate"><span class="pre">ophys_session_table</span></code> and <code class="docutils literal notranslate"><span class="pre">behavior_session_table</span></code>, plus a few additional ones specific to individual imaging planes, including <code class="docutils literal notranslate"><span class="pre">imaging_depth</span></code> and <code class="docutils literal notranslate"><span class="pre">targeted_structure</span></code>.</p>
<p><b> Here is how to load the <code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code> </b></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ophys_experiments</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_ophys_experiment_table</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of ophys experiments: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ophys_experiments</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ophys_experiments</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>Compare the columns of <code class="docutils literal notranslate"><span class="pre">ophys_sessions_table</span></code> with <code class="docutils literal notranslate"><span class="pre">ophys_experiments_table</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ophys_sessions</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ophys_experiments</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<section id="imaging-plane-specific-metadata">
<h2>Imaging plane specific metadata<a class="headerlink" href="#imaging-plane-specific-metadata" title="Permalink to this heading">#</a></h2>
<dl class="simple myst">
<dt>imaging_depth</dt><dd><p>int	depth in microns from the cortical surface, where the data for a given imaging plane was collected</p>
</dd>
<dt>targeted_structure</dt><dd><p>string	 brain area targeted for a given imaging plane</p>
</dd>
</dl>
<p>What <code class="docutils literal notranslate"><span class="pre">imaging_depths</span></code> and <code class="docutils literal notranslate"><span class="pre">targeted_structures</span></code> are available? Are they different depending on <code class="docutils literal notranslate"><span class="pre">project_code</span></code>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># loop through project codes and print the available imaging_depths and targeted_structures</span>
<span class="k">for</span> <span class="n">project_code</span> <span class="ow">in</span> <span class="n">ophys_experiments</span><span class="o">.</span><span class="n">project_code</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    
    <span class="n">project_experiments</span> <span class="o">=</span> <span class="n">ophys_experiments</span><span class="p">[</span><span class="n">ophys_experiments</span><span class="o">.</span><span class="n">project_code</span><span class="o">==</span><span class="n">project_code</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">imaging_depths available for&#39;</span><span class="p">,</span> <span class="n">project_code</span><span class="p">,</span> <span class="s1">&#39;include: &#39;</span><span class="p">,</span> <span class="n">project_experiments</span><span class="o">.</span><span class="n">imaging_depth</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">targeted_structures available for&#39;</span><span class="p">,</span> <span class="n">project_code</span><span class="p">,</span> <span class="s1">&#39;include: &#39;</span><span class="p">,</span> <span class="n">project_experiments</span><span class="o">.</span><span class="n">targeted_structure</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="properties-of-session-types">
<h2>Properties of session types<a class="headerlink" href="#properties-of-session-types" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code> also includes a useful parsing of the <code class="docutils literal notranslate"><span class="pre">session_type</span></code> and <code class="docutils literal notranslate"><span class="pre">prior_exposures_to_image_set</span></code> columns that allows you to filter the data by what <code class="docutils literal notranslate"><span class="pre">image_set</span></code> was used, whether a session is active behavior or <code class="docutils literal notranslate"><span class="pre">passive</span></code> viewing, and whether the session was the first exposure to the novel image set or a subsequent exposure (the <code class="docutils literal notranslate"><span class="pre">experience_level</span></code>).</p>
<dl class="simple myst">
<dt>image_set</dt><dd><p>string image set shown in that session</p>
</dd>
<dt>passive</dt><dd><p>Boolean True for sessions where the lick spout was removed so that no rewards were delivered, and the mouse received its daily water prior to the session</p>
</dd>
<dt>experience_level</dt><dd><p>string ‘Familiar’: image set mouse was trained on, ‘Novel 1’: the first session with the novel image set, ‘Novel &gt;1’: a subsequent session with the novel image set</p>
</dd>
</dl>
</section>
<section id="ophys-containers">
<h2>Ophys containers<a class="headerlink" href="#ophys-containers" title="Permalink to this heading">#</a></h2>
<p><b> The <code class="docutils literal notranslate"><span class="pre">ophys_experiment_table</span></code> is useful for identifying <b>ophys containers</b> to analyze </b></p>
<p>Each <code class="docutils literal notranslate"><span class="pre">ophys_experiment_id</span></code> represents a single imaging plane recorded in a specific session, and is associated with a single <code class="docutils literal notranslate"><span class="pre">ophys_session_id</span></code>. The <code class="docutils literal notranslate"><span class="pre">ophys_container_id</span></code> indicates the collection of ophys sessions for a given imaging plane and can be used to identify all the sessions available for a given population of neurons.</p>
<p>Group ophys experiments by the <code class="docutils literal notranslate"><span class="pre">ophys_container_id</span></code> and count the number of experiments (unique fields of view recorded in unique sessions) that are available for each container.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ophys_experiments</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ophys_container_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[[</span><span class="s1">&#39;ophys_session_id&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>Group ophys experiments by the <code class="docutils literal notranslate"><span class="pre">ophys_container_id</span></code> and the <code class="docutils literal notranslate"><span class="pre">session_type</span></code> and count the number of experiments (unique fields of view recorded in unique sessions) that are available for each session type for each container (i.e. field of view). Do all containers have the same <code class="docutils literal notranslate"><span class="pre">session_types</span></code>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># First lets check the first few containers</span>
<span class="n">ophys_experiments</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ophys_container_id&#39;</span><span class="p">,</span> <span class="s1">&#39;session_type&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[[</span><span class="s1">&#39;ophys_session_id&#39;</span><span class="p">]][:</span><span class="mi">25</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now lets check the last few containers</span>
<span class="n">ophys_experiments</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ophys_container_id&#39;</span><span class="p">,</span> <span class="s1">&#39;session_type&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[[</span><span class="s1">&#39;ophys_session_id&#39;</span><span class="p">]][</span><span class="o">-</span><span class="mi">25</span><span class="p">:]</span>
</pre></div>
</div>
</section>
<section id="ophys-cells-table">
<h2>Ophys cells table<a class="headerlink" href="#ophys-cells-table" title="Permalink to this heading">#</a></h2>
<p>################## TBD ####################</p>
<p>For additional info about the contents of the metadata tables, check out <a class="reference external" href="https://allensdk.readthedocs.io/en/latest/_static/examples/nb/visual_behavior_ophys_dataset_manifest.html">this tutorial</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "allensdk"
        },
        kernelOptions: {
            name: "allensdk",
            path: "./visual-behavior"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'allensdk'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="VB-Ophys.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Visual Behavior Ophys Dataset Overview</p>
      </div>
    </a>
    <a class="right-next"
       href="VBO-ExperimentData.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visual Behavior Ophys Experiment Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Visual Behavior Ophys Dataset</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#vbo-metadata-tables">VBO Metadata Tables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#behavior-sessions">Behavior sessions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-sessions">Ophys sessions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-experiments">Ophys experiments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-cells">Ophys cells</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#behavior-sessions-table">Behavior Sessions Table</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mouse-specific-metadata">Mouse specific metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-variants">Dataset variants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#session-types">Session Types</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-sessions-table">Ophys Sessions Table</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-experiment-table">Ophys Experiment Table</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imaging-plane-specific-metadata">Imaging plane specific metadata</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-session-types">Properties of session types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-containers">Ophys containers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ophys-cells-table">Ophys cells table</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Saskia de Vries, Marina Garrett, Corbett Bennet, Galen Lynch, Anna Lakunina, Casey Schneider-Mizell
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>