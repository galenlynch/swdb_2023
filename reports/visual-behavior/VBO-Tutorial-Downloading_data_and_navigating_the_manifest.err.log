Traceback (most recent call last):
  File "/opt/conda/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/conda/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/conda/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/conda/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/opt/conda/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/opt/conda/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/conda/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
output_dir = Path(output_dir)

cache = VisualBehaviorOphysProjectCache.from_s3_cache(cache_dir=output_dir)
------------------

----- stderr -----
/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:413: MissingLocalManifestWarning: This cache directory appears to contain data files, but it has no record of what those files are. You might want to consider running

VisualBehaviorOphysProjectCache.construct_local_manifest()

to avoid needlessly downloading duplicates of data files that did not change between data releases. NOTE: running this method will require hashing every data file you have currently downloaded and could be very time consuming.

To avoid this warning in the future, make sure that

/root/capsule/data/visual-behavior-ophys/_downloaded_data.json

is not deleted between instantiations of this cache
  warnings.warn(msg, MissingLocalManifestWarning)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mOSError[0m                                   Traceback (most recent call last)
Cell [0;32mIn[4], line 3[0m
[1;32m      1[0m output_dir [38;5;241m=[39m Path(output_dir)
[0;32m----> 3[0m cache [38;5;241m=[39m [43mVisualBehaviorOphysProjectCache[49m[38;5;241;43m.[39;49m[43mfrom_s3_cache[49m[43m([49m[43mcache_dir[49m[38;5;241;43m=[39;49m[43moutput_dir[49m[43m)[49m

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/brain_observatory/behavior/behavior_project_cache/project_cache_base.py:77[0m, in [0;36mProjectCacheBase.from_s3_cache[0;34m(cls, cache_dir, bucket_name_override)[0m
[1;32m     50[0m [38;5;129m@classmethod[39m
[1;32m     51[0m [38;5;28;01mdef[39;00m [38;5;21mfrom_s3_cache[39m(
[1;32m     52[0m         [38;5;28mcls[39m,
[1;32m     53[0m         cache_dir: Union[[38;5;28mstr[39m, Path],
[1;32m     54[0m         bucket_name_override: Optional[[38;5;28mstr[39m] [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m     55[0m ) [38;5;241m-[39m[38;5;241m>[39m [38;5;124m"[39m[38;5;124mProjectCacheBase[39m[38;5;124m"[39m:
[1;32m     56[0m [38;5;250m    [39m[38;5;124;03m"""instantiates this object with a connection to an s3 bucket and/or[39;00m
[1;32m     57[0m [38;5;124;03m    a local cache related to that bucket.[39;00m
[1;32m     58[0m 
[0;32m   (...)[0m
[1;32m     74[0m 
[1;32m     75[0m [38;5;124;03m    """[39;00m
[0;32m---> 77[0m     fetch_api [38;5;241m=[39m [38;5;28;43mcls[39;49m[38;5;241;43m.[39;49m[43mcloud_api_class[49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43mfrom_s3_cache[49m[43m([49m
[1;32m     78[0m [43m        [49m[43mcache_dir[49m[43m,[49m
[1;32m     79[0m [43m        [49m[43mbucket_name[49m[38;5;241;43m=[39;49m[43m([49m
[1;32m     80[0m [43m            [49m[43mbucket_name_override[49m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mbucket_name_override[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[38;5;129;43;01mnot[39;49;00m[43m [49m[38;5;28;43;01mNone[39;49;00m
[1;32m     81[0m [43m            [49m[38;5;28;43;01melse[39;49;00m[43m [49m[38;5;28;43mcls[39;49m[38;5;241;43m.[39;49m[43mBUCKET_NAME[49m[43m)[49m[43m,[49m
[1;32m     82[0m [43m        [49m[43mproject_name[49m[38;5;241;43m=[39;49m[38;5;28;43mcls[39;49m[38;5;241;43m.[39;49m[43mPROJECT_NAME[49m[43m,[49m
[1;32m     83[0m [43m        [49m[43mui_class_name[49m[38;5;241;43m=[39;49m[38;5;28;43mcls[39;49m[38;5;241;43m.[39;49m[38;5;18;43m__name__[39;49m[43m)[49m
[1;32m     85[0m     [38;5;28;01mreturn[39;00m [38;5;28mcls[39m(fetch_api[38;5;241m=[39mfetch_api)

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/brain_observatory/behavior/behavior_project_cache/project_apis/data_io/project_cloud_api_base.py:112[0m, in [0;36mProjectCloudApiBase.from_s3_cache[0;34m(cls, cache_dir, bucket_name, project_name, ui_class_name)[0m
[1;32m     83[0m [38;5;250m[39m[38;5;124;03m"""instantiates this object with a connection to an s3 bucket and/or[39;00m
[1;32m     84[0m [38;5;124;03ma local cache related to that bucket.[39;00m
[1;32m     85[0m 
[0;32m   (...)[0m
[1;32m    106[0m 
[1;32m    107[0m [38;5;124;03m"""[39;00m
[1;32m    108[0m cache [38;5;241m=[39m S3CloudCache(cache_dir,
[1;32m    109[0m                      bucket_name,
[1;32m    110[0m                      project_name,
[1;32m    111[0m                      ui_class_name[38;5;241m=[39mui_class_name)
[0;32m--> 112[0m [38;5;28;01mreturn[39;00m [38;5;28;43mcls[39;49m[43m([49m[43mcache[49m[43m)[49m

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/brain_observatory/behavior/behavior_project_cache/project_apis/data_io/project_cloud_api_base.py:39[0m, in [0;36mProjectCloudApiBase.__init__[0;34m(self, cache, skip_version_check, local)[0m
[1;32m     37[0m [38;5;28mself[39m[38;5;241m.[39mskip_version_check [38;5;241m=[39m skip_version_check
[1;32m     38[0m [38;5;28mself[39m[38;5;241m.[39m_local [38;5;241m=[39m local
[0;32m---> 39[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mload_manifest[49m[43m([49m[43m)[49m

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/brain_observatory/behavior/behavior_project_cache/project_apis/data_io/project_cloud_api_base.py:52[0m, in [0;36mProjectCloudApiBase.load_manifest[0;34m(self, manifest_name)[0m
[1;32m     42[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m     43[0m [38;5;124;03mLoad the specified manifest file into the CloudCache[39;00m
[1;32m     44[0m 
[0;32m   (...)[0m
[1;32m     49[0m [38;5;124;03m    (default: None)[39;00m
[1;32m     50[0m [38;5;124;03m"""[39;00m
[1;32m     51[0m [38;5;28;01mif[39;00m manifest_name [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m---> 52[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcache[49m[38;5;241;43m.[39;49m[43mload_last_manifest[49m[43m([49m[43m)[49m
[1;32m     53[0m [38;5;28;01melse[39;00m:
[1;32m     54[0m     [38;5;28mself[39m[38;5;241m.[39mcache[38;5;241m.[39mload_manifest(manifest_name)

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:493[0m, in [0;36mCloudCacheBase.load_last_manifest[0;34m(self)[0m
[1;32m    487[0m [38;5;250m[39m[38;5;124;03m"""[39;00m
[1;32m    488[0m [38;5;124;03mIf this Cache was used previously, load the last manifest[39;00m
[1;32m    489[0m [38;5;124;03mused in this cache. If this cache has never been used, load[39;00m
[1;32m    490[0m [38;5;124;03mthe latest manifest.[39;00m
[1;32m    491[0m [38;5;124;03m"""[39;00m
[1;32m    492[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28mself[39m[38;5;241m.[39m_manifest_last_used[38;5;241m.[39mexists():
[0;32m--> 493[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mload_latest_manifest[49m[43m([49m[43m)[49m
[1;32m    494[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mNone[39;00m
[1;32m    496[0m [38;5;28;01mwith[39;00m [38;5;28mopen[39m([38;5;28mself[39m[38;5;241m.[39m_manifest_last_used, [38;5;124m'[39m[38;5;124mr[39m[38;5;124m'[39m) [38;5;28;01mas[39;00m in_file:

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:541[0m, in [0;36mCloudCacheBase.load_latest_manifest[0;34m(self)[0m
[1;32m    539[0m         msg [38;5;241m+[39m[38;5;241m=[39m [38;5;124mf[39m[38;5;124m"[39m[38;5;132;01m{[39;00m[38;5;28mself[39m[38;5;241m.[39mui[38;5;132;01m}[39;00m[38;5;124m.load_manifest([39m[38;5;124m'[39m[38;5;132;01m{[39;00mlatest_downloaded[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m)[39m[38;5;124m"[39m
[1;32m    540[0m         warnings[38;5;241m.[39mwarn(msg, OutdatedManifestWarning)
[0;32m--> 541[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mload_manifest[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mlatest_manifest_file[49m[43m)[49m

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:608[0m, in [0;36mCloudCacheBase.load_manifest[0;34m(self, manifest_name)[0m
[1;32m    606[0m manifest_path [38;5;241m=[39m os[38;5;241m.[39mpath[38;5;241m.[39mjoin([38;5;28mself[39m[38;5;241m.[39m_cache_dir, manifest_name)
[1;32m    607[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m os[38;5;241m.[39mpath[38;5;241m.[39mexists(manifest_path):
[0;32m--> 608[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_download_manifest[49m[43m([49m[43mmanifest_name[49m[43m)[49m
[1;32m    610[0m [38;5;28mself[39m[38;5;241m.[39m_manifest [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_load_manifest(manifest_name)
[1;32m    612[0m [38;5;66;03m# Keep track of the newly loaded manifest[39;00m

File [0;32m/opt/envs/allensdk/lib/python3.8/site-packages/allensdk/api/cloud_cache/cloud_cache.py:1091[0m, in [0;36mS3CloudCache._download_manifest[0;34m(self, manifest_name)[0m
[1;32m   1086[0m response [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39ms3_client[38;5;241m.[39mget_object(Bucket[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39m_bucket_name,
[1;32m   1087[0m                                      Key[38;5;241m=[39mmanifest_key)
[1;32m   1089[0m filepath [38;5;241m=[39m os[38;5;241m.[39mpath[38;5;241m.[39mjoin([38;5;28mself[39m[38;5;241m.[39m_cache_dir, manifest_name)
[0;32m-> 1091[0m [38;5;28;01mwith[39;00m [38;5;28;43mopen[39;49m[43m([49m[43mfilepath[49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mwb[39;49m[38;5;124;43m'[39;49m[43m)[49m [38;5;28;01mas[39;00m f:
[1;32m   1092[0m     [38;5;28;01mfor[39;00m chunk [38;5;129;01min[39;00m response[[38;5;124m'[39m[38;5;124mBody[39m[38;5;124m'[39m][38;5;241m.[39miter_chunks():
[1;32m   1093[0m         f[38;5;241m.[39mwrite(chunk)

[0;31mOSError[0m: [Errno 30] Read-only file system: '/root/capsule/data/visual-behavior-ophys/visual-behavior-ophys_project_manifest_v1.0.1.json'

